<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ARGON | Detalles</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; -webkit-tap-highlight-color: transparent; }
        .config-card { transition: all 0.3s ease; }
        .selected-option { border-color: #92400e !important; background-color: #fffbeb !important; }
    </style>
</head>
<body class="bg-zinc-50 pb-24">

    <nav class="p-4 flex items-center justify-between bg-white border-b border-zinc-100 sticky top-0 z-50">
        <a href="javascript:history.back()" class="text-zinc-400 hover:text-zinc-800 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
        </a>
        <h2 class="font-bold text-zinc-800 uppercase tracking-widest text-sm">Configuración</h2>
        <div class="w-6"></div> </nav>

    <main class="max-w-2xl mx-auto p-4">
        <div class="rounded-[2.5rem] overflow-hidden shadow-2xl bg-white mb-8 border border-zinc-100 aspect-square md:aspect-video relative">
            <img id="m-img" src="" alt="Cargando..." class="w-full h-full object-cover">
        </div>

        <div class="mb-8 text-center">
            <h1 id="m-nombre" class="text-3xl font-black text-zinc-900 italic uppercase leading-none mb-2">Cargando...</h1>
            <p class="text-amber-700 font-bold text-xs uppercase tracking-[0.3em]">Artesanía Personalizada</p>
        </div>

        <div class="space-y-6">
            <section>
                <h3 class="text-xs font-black uppercase tracking-widest text-zinc-400 mb-4 ml-2">Selecciona la Madera</h3>
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="seleccionar(this, 'madera')" class="config-card p-4 rounded-2xl border-2 border-zinc-100 bg-white text-left hover:border-amber-200">
                        <span class="block font-bold text-zinc-800">Cedro</span>
                        <span class="text-[10px] text-zinc-400 uppercase">Premium</span>
                    </button>
                    <button onclick="seleccionar(this, 'madera')" class="config-card p-4 rounded-2xl border-2 border-zinc-100 bg-white text-left hover:border-amber-200">
                        <span class="block font-bold text-zinc-800">Caoba</span>
                        <span class="text-[10px] text-zinc-400 uppercase">Elegante</span>
                    </button>
                </div>
            </section>
        </div>

        <div class="fixed bottom-0 left-0 right-0 p-4 bg-white/80 backdrop-blur-md border-t border-zinc-100">
            <button onclick="agregarAlCarrito()" class="w-full bg-zinc-900 text-white py-4 rounded-2xl font-bold text-lg active:scale-95 transition-transform shadow-xl">
                Añadir al Carrito
            </button>
        </div>
    </main>

    <script>
        // --- LÓGICA DE CARGA DE IMAGEN INTELIGENTE ---
        const params = new URLSearchParams(window.location.search);
        const nombre = params.get('nombre') || 'Mueble Argon';
        let imgUrl = params.get('img');

        // 1. Corregir caracteres de la URL (para Unsplash)
        if (imgUrl) {
            imgUrl = imgUrl.replace(/\|/g, '&');
        }

        // 2. Inyectar nombre
        document.getElementById('m-nombre').innerText = nombre;

        // 3. Inyectar imagen con sistema de seguridad
        const imagenPrincipal = document.getElementById('m-img');

        if (imagenPrincipal && imgUrl) {
            // Intentamos cargar la imagen
            imagenPrincipal.src = imgUrl;

            // Si falla (sale el cuadro blanco), ejecutamos este código:
            imagenPrincipal.onerror = function() {
                console.log("Error cargando ruta original, intentando solución...");
                
                // Si la imagen NO es de internet (es local)
                if (!imgUrl.startsWith('http')) {
                    // Intento A: Forzar búsqueda en la raíz
                    if (!imgUrl.startsWith('./')) {
                        this.src = './' + imgUrl;
                    } 
                    // Intento B: Si sigue fallando, poner imagen de error elegante
                    else {
                        this.src = 'https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=800';
                        console.warn("Imagen local no encontrada. Se cargó respaldo.");
                    }
                }
            };
        }

        // --- FUNCIONES INTERACTIVAS ---
        function seleccionar(el, grupo) {
            // Deseleccionar otros del mismo grupo
            el.parentElement.querySelectorAll('button').forEach(btn => btn.classList.remove('selected-option'));
            // Seleccionar el actual
            el.classList.add('selected-option');
            if (window.navigator.vibrate) window.navigator.vibrate(10);
        }

        function agregarAlCarrito() {
            // Aquí iría tu lógica de localStorage para guardar el pedido
            alert("¡Añadido al carrito!");
            window.location.href = 'carrito.html';
        }
    </script>
</body>
</html>