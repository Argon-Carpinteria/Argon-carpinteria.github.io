<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARGON | Cotizador Profesional</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; }
        .label-estilo { display: block; text-transform: uppercase; font-size: 0.75rem; font-weight: 700; color: #71717a; margin-bottom: 0.5rem; letter-spacing: 0.05em; }
        .input-estilo { width: 100%; background-color: #f4f4f5; border: 2px solid #e4e4e7; padding: 1rem; border-radius: 1.25rem; outline: none; font-weight: 600; color: #18181b; appearance: none; cursor: pointer; transition: all 0.2s ease; }
        .input-estilo:focus { border-color: #b45309; background-color: white; }
    </style>
</head>
<body class="bg-zinc-50 text-zinc-900">

    <nav class="fixed top-0 w-full z-50 p-6 pointer-events-none">
        <button onclick="window.history.back()" class="pointer-events-auto bg-white/90 backdrop-blur-md text-amber-900 font-bold px-6 py-3 rounded-2xl shadow-xl flex items-center gap-2 border border-amber-100">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
            Volver
        </button>
    </nav>

    <div class="w-full h-[55vh] relative bg-zinc-200">
        <img id="producto-img" src="sofa-gris.png" class="w-full h-full object-cover transition-opacity duration-300">
    </div>

    <main class="max-w-4xl mx-auto px-6 pb-20 -mt-20 relative z-10">
        <div class="bg-white rounded-[3rem] shadow-2xl p-8 md:p-14 border border-zinc-100">
            
            <div class="text-center mb-10">
                <span id="categoria-tag" class="text-amber-700 font-bold uppercase tracking-widest text-xs">Personalizando tu Mueble</span>
                <h1 id="producto-nombre" class="text-4xl font-bold text-zinc-800 italic uppercase">Conjunto Minimalista</h1>
            </div>

            <div class="bg-zinc-900 rounded-[2rem] p-8 mb-8 text-center text-white">
                <span class="text-zinc-500 text-xs font-bold">PRESUPUESTO ESTIMADO</span>
                <div class="text-5xl font-bold mt-2"><span id="precio-dinamico">0</span> <span class="text-amber-500 text-xl">CUP</span></div>
            </div>

            <div id="configurador-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
                <div>
                    <label class="label-estilo">Dimensiones</label>
                    <select id="opt1" onchange="actualizarMueble()" class="input-estilo">
                        <option value="Pequeño" data-p="25000">Tamaño S</option>
                        <option value="Mediano" data-p="45000">Tamaño M</option>
                        <option value="Grande" data-p="75000">Tamaño L</option>
                    </select>
                </div>
                <div>
                    <label class="label-estilo">Madera Principal</label>
                    <select id="opt2" onchange="actualizarMueble()" class="input-estilo">
                        <option value="Pino" data-p="0">Pino Tratado</option>
                        <option value="Cedro" data-p="15000">Cedro Real (+15k)</option>
                    </select>
                </div>
                <div>
                    <label class="label-estilo">Tipo de Tela</label>
                    <select id="opt3" onchange="actualizarMueble()" class="input-estilo">
                        <option value="Polipiel" data-p="5000">Polipiel</option>
                        <option value="Chenille" data-p="8000">Chenille</option>
                        <option value="Algodon" data-p="3000">Algodón</option>
                    </select>
                </div>
                <div>
                    <label class="label-estilo">Color de Tela</label>
                    <select id="opt4" onchange="actualizarMueble()" class="input-estilo">
                        <option value="Gris Claro" data-img="sofa-gris.png">Gris Claro</option>
                        <option value="Cafe Claro" data-img="sofa-cafe.png">Café Claro</option>
                        <option value="Negro" data-img="sofa-negro.png">Negro</option>
                    </select>
                </div>
            </div>

            <button id="btn-continuar" class="w-full bg-amber-700 hover:bg-amber-800 text-white py-6 rounded-2xl font-bold text-xl shadow-xl transition-all active:scale-95">
                Añadir al Carrito
            </button>
        </div>
    </main>

    <script>
        function actualizarMueble() {
            const v1 = document.getElementById('opt1');
            const v2 = document.getElementById('opt2');
            const v3 = document.getElementById('opt3');
            const v4 = document.getElementById('opt4');
            const imgDisplay = document.getElementById('producto-img');

            // 1. Cambio de Imagen Real
            const nuevaFoto = v4.options[v4.selectedIndex].getAttribute('data-img');
            imgDisplay.style.opacity = "0.5";
            setTimeout(() => {
                imgDisplay.src = nuevaFoto;
                imgDisplay.style.opacity = "1";
            }, 100);

            // 2. Cálculo de Precio
            const total = (parseInt(v1.options[v1.selectedIndex].dataset.p) || 0) +
                          (parseInt(v2.options[v2.selectedIndex].dataset.p) || 0) +
                          (parseInt(v3.options[v3.selectedIndex].dataset.p) || 0);
            
            document.getElementById('precio-dinamico').innerText = total.toLocaleString('es-ES');

            // 3. LOGICA PARA GUARDAR EN CARRITO
            document.getElementById('btn-continuar').onclick = () => {
                // Creamos el objeto con TODOS los detalles
                const productoPersonalizado = {
                    nombre: document.getElementById('producto-nombre').innerText,
                    precio: total, // Guardamos el número limpio
                    p1: v1.value,      // Dimensión
                    madera: v2.value,  // Madera
                    tela: v3.value,    // Tela
                    color: v4.value,   // Color
                    categoria: document.getElementById('categoria-tag').innerText,
                    img: nuevaFoto
                };

                // Guardar en LocalStorage
                let carrito = JSON.parse(localStorage.getItem('carritoArgon')) || [];
                carrito.push(productoPersonalizado);
                localStorage.setItem('carritoArgon', JSON.stringify(carrito));

                // Redirigir al carrito
                window.location.href = 'carrito.html';
            };
        }

        window.onload = actualizarMueble;
    </script>
</body>
</html>